Для тестового стенда использовал Vagrant, VirtualBox и Ansible на WSL(т.к. мой дом. ноутбук на Windows, но в `Vagrantfile` прописал Ansible для *unix машин).

В `Vagrantfile` описана конфигурация для создания и настройки виртуальных машин с использованием Vagrant и VirtualBox. Вот основные настройки:
1. Настройка nginx серверов:
Создаются три виртуальные машины (nginx1, nginx2, nginx3), каждая из которых использует образ ubuntu/focal64.
Каждой машине присваивается приватный IP-адрес в формате 192.168.50.10X, где X - номер машины (1, 2, 3).
Отключена синхронизация папок с хост-машины.
Для каждой машины выделено 1024 МБ оперативной памяти и 2 CPU.
(Для настройки используется Ansible с плейбуком nginx-setup.yml, где каждая машина включена в группу nginx_servers.)*
2. Настройка приложения:
Создается одна виртуальная машина app, также использующая образ ubuntu/focal64.
Машине присваивается IP-адрес 192.168.50.200.
Выделено 2048 МБ оперативной памяти и 2 CPU.
(Для настройки используется Ansible с плейбуком app-setup.yml.)*
Эти настройки позволяют развернуть и настроить серверы nginx и приложение в изолированной среде для разработки или тестирования.
()* Для *unix машин, для Windows нужно запускать плейбуки отдельно и закоментировать строки в `Vagrantfile` отвечающие за ansible

Блок настроек в файле `nginx.conf.j2` определяет конфигурацию для веб-сервера Nginx. Вот описание каждой директивы внутри блока server:
1. Блок events:
worker_connections 1024; - устанавливает максимальное количество соединений, которые может обрабатывать один рабочий процесс. Здесь установлено значение 1024.
2. Блок http:
Внутри блока http находится конфигурация одного сервера.
listen 80; - сервер слушает порт 80, что является стандартным портом для HTTP.
server_name $host; - имя сервера устанавливается в значение переменной $host, которая динамически определяется.
Блок location /:
proxy_pass http://192.168.50.200; - запросы к серверу перенаправляются на внутренний адрес 192.168.50.200 (app).
proxy_set_header Host $host; - устанавливает заголовок Host в значение переменной $host.
proxy_set_header X-Real-IP $remote_addr; - передает исходный IP-адрес клиента серверу, на который перенаправляется запрос.
proxy_set_header X-Forwarded-For $remote_addr; - добавляет IP-адрес клиента в заголовок X-Forwarded-For для идентификации исходного IP-адреса.
proxy_set_header X-Forwarded-Proto $scheme; - передает используемую схему (http или https) в заголовке X-Forwarded-Proto.
Эта конфигурация позволяет Nginx выступать в роли обратного прокси, перенаправляя входящие HTTP-запросы на внутренний сервер по адресу 192.168.50.200 (app), при этом сохраняя информацию о исходном запросе для последующей обработки на бэкенде.

Вывод логов на сервере приложения 192.168.50.200 (app):
vagrant@app:~$ tail -f /var/log/nginx/myapp_access.log
192.168.50.103 - - [15/May/2024:14:36:02 +0000] "GET / HTTP/1.0" 200 288 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0"
192.168.50.103 - - [15/May/2024:14:36:24 +0000] "GET /favicon.ico HTTP/1.0" 404 162 "http://192.168.50.103/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0"
192.168.50.101 - - [15/May/2024:14:36:37 +0000] "GET / HTTP/1.0" 200 288 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0"
192.168.50.101 - - [15/May/2024:14:36:38 +0000] "GET /favicon.ico HTTP/1.0" 404 162 "http://192.168.50.101/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0"
192.168.50.102 - - [15/May/2024:14:36:50 +0000] "GET / HTTP/1.0" 200 288 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0"
192.168.50.102 - - [15/May/2024:14:36:51 +0000] "GET /favicon.ico HTTP/1.0" 404 162 "http://192.168.50.102/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0"
192.168.50.1 - - [15/May/2024:14:36:59 +0000] "GET / HTTP/1.1" 200 231 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0"
192.168.50.1 - - [15/May/2024:14:37:00 +0000] "GET /favicon.ico HTTP/1.1" 404 134 "http://192.168.50.200/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0"
